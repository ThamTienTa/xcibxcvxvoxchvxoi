<!DOCTYPE html>
<html lang="vn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>L·ªõp 7A7 - Trung T√¢m</title>
    <link href="https://fonts.googleapis.com/css2?family=Chewy&family=Nunito:wght@400;700;800&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background: #a9d593;
            min-height: 100vh;
            padding: 40px 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: left;
            margin-bottom: 60px;
        }

        .header-badge {
            display: inline-block;
            background: linear-gradient(135deg, #FFE066 0%, #FFD147 100%);
            padding: 20px 60px;
            border-radius: 50px;
            transform: rotate(-2deg);
            box-shadow: 
                0 8px 16px rgba(0, 0, 0, 0.15),
                inset 0 -2px 0 rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            border: 4px solid #333;
        }

        .header-badge h1 {
            font-family: 'Chewy', cursive;
            font-size: 72px;
            color: #FF6B6B;
            text-shadow: 
                3px 3px 0px #333,
                -1px -1px 0px #fff;
            letter-spacing: 4px;
            margin: 0;
        }

        .subtitle-badge {
            display: inline-block;
            background: #FFF8E1;
            padding: 15px 40px;
            border-radius: 40px;
            border: 3px solid #333;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .subtitle-badge h2 {
            font-family: 'Chewy', cursive;
            font-size: 42px;
            color: #FF6B6B;
            text-shadow: 2px 2px 0px rgba(0, 0, 0, 0.1);
            margin: 0;
        }

        .class-name {
            font-size: 56px;
            font-weight: 800;
            color: #2d3436;
            margin-top: 30px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        .grid-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }

        .grid-item {
            background: white;
            border: 4px solid #333;
            border-radius: 20px;
            padding: 30px 25px;
            display: flex;
            align-items: center;
            gap: 20px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            box-shadow: 
                0 6px 0 #333,
                0 8px 12px rgba(0, 0, 0, 0.15);
            position: relative;
        }

        .grid-item:hover {
            transform: translateY(-8px);
            box-shadow: 
                0 10px 0 #333,
                0 12px 20px rgba(0, 0, 0, 0.2);
        }

        .grid-item:active {
            transform: translateY(-2px);
            box-shadow: 
                0 4px 0 #333,
                0 6px 8px rgba(0, 0, 0, 0.15);
        }

        .icon-box {
            width: 70px;
            height: 70px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            border: 3px solid #333;
            flex-shrink: 0;
            box-shadow: inset 0 -3px 0 rgba(0, 0, 0, 0.1);
        }

        .grid-item:nth-child(1) .icon-box { background: #87CEEB; }
        .grid-item:nth-child(2) .icon-box { background: #DDA0DD; }
        .grid-item:nth-child(3) .icon-box { background: #FFB6C1; }
        .grid-item:nth-child(4) .icon-box { background: #FFB347; }
        .grid-item:nth-child(5) .icon-box { background: #B19CD9; }
        .grid-item:nth-child(6) .icon-box { background: #FFB6D9; }

        .grid-text {
            flex: 1;
            text-align: left;
        }

        .grid-text h3 {
            font-size: 22px;
            font-weight: 800;
            color: #2d3436;
            line-height: 1.3;
            margin: 0;
        }

        /* Modal styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border: 4px solid #333;
            border-radius: 25px;
            padding: 40px;
            max-width: 800px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            animation: slideUp 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid #333;
        }

        .modal-header h2 {
            font-family: 'Chewy', cursive;
            font-size: 36px;
            color: #FF6B6B;
            margin: 0;
        }

        .close-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #FF6B6B;
            border: 3px solid #333;
            color: white;
            font-size: 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            transition: all 0.2s;
        }

        .close-btn:hover {
            transform: rotate(90deg);
            background: #FF5252;
        }

        .modal-body {
            font-size: 18px;
            line-height: 1.8;
            color: #2d3436;
            text-align: left;
        }

        .modal-body h3 {
            font-size: 24px;
            margin: 20px 0 10px 0;
            color: #FF6B6B;
        }

        .modal-body h4 {
            font-size: 20px;
            margin: 15px 0 8px 0;
            color: #498e4c;
        }

        .modal-body ul {
            margin-left: 25px;
            margin-bottom: 15px;
        }

        .modal-body li {
            margin-bottom: 8px;
        }

        .modal-body .announcement {
            background-color: #f9f9f9;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 8px;
            border-left: 4px solid #498e4c;
        }

        .online-counter {
            text-align: center;
            margin-top: 30px;
            background: white;
            border: 4px solid #333;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 6px 0 #333;
        }

        .online-counter h3 {
            color: #498e4c;
            margin: 0 0 10px 0;
            font-size: 24px;
        }

        .online-counter .count {
            font-size: 48px;
            font-weight: 800;
            color: #FF6B6B;
            margin: 0;
        }

        .online-counter p {
            margin: 10px 0 0 0;
            color: #666;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideUp {
            from { 
                opacity: 0;
                transform: translateY(50px) scale(0.9);
            }
            to { 
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        @media (max-width: 768px) {
            .header-badge h1 {
                font-size: 48px;
            }
            
            .subtitle-badge h2 {
                font-size: 32px;
            }
            
            .class-name {
                font-size: 40px;
            }

            .grid-container {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-badge">
                <h1>L·ªöP H·ªåC</h1>
            </div>
            <div class="subtitle-badge">
                <h2>TRUNG T√ÇM</h2>
            </div>
            <div class="class-name">L·ªõp 7A7</div>
        </div>

        <div class="grid-container">
            <div class="grid-item" onclick="openModal('nhom-chat')">
                <div class="icon-box">üí¨</div>
                <div class="grid-text">
                    <h3>Nh√≥m<br>Chat</h3>
                </div>
            </div>

            <div class="grid-item" onclick="openModal('tin-tuc')">
                <div class="icon-box">üìù</div>
                <div class="grid-text">
                    <h3>Tin t·ª©c l·ªõp<br>h·ªçc</h3>
                </div>
            </div>

            <div class="grid-item" onclick="openModal('hoi-bai')">
                <div class="icon-box">‚ùì</div>
                <div class="grid-text">
                    <h3>H·ªèi<br>B√†i</h3>
                </div>
            </div>

            <div class="grid-item" onclick="openModal('hoc-tap')">
                <div class="icon-box">üìö</div>
                <div class="grid-text">
                    <h3>H·ªçc<br>T·∫≠p</h3>
                </div>
            </div>

            <div class="grid-item" onclick="openModal('lich-hoc')">
                <div class="icon-box">üìÖ</div>
                <div class="grid-text">
                    <h3>L·ªãch l·ªõp<br>h·ªçc</h3>
                </div>
            </div>

            <div class="grid-item" onclick="openModal('pomodoro')">
                <div class="icon-box">‚è±Ô∏è</div>
                <div class="grid-text">
                    <h3>Pomodoro<br>Timer</h3>
                </div>
            </div>
        </div>
        
        <!-- Online Users Counter -->
        <div class="online-counter">
            <h3>üë• ƒêang online</h3>
            <p class="count" id="onlineCount">0</p>
            <p>ng∆∞·ªùi ƒëang truy c·∫≠p</p>
        </div>
    </div>

    <!-- Modals -->
    <!-- Nh√≥m Chat Modal -->
    <div id="modal-nhom-chat" class="modal" onclick="closeModal(event, 'nhom-chat')">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h2>üí¨ Nh√≥m Chat</h2>
                <button class="close-btn" onclick="closeModal(event, 'nhom-chat')">√ó</button>
            </div>
            <div class="modal-body">
                <h3>Chat v·ªõi b·∫°n b√® trong l·ªõp</h3>
                <div class="chat-messages" id="chatMessages" style="max-height: 400px; overflow-y: auto; border: 2px solid #498e4c; padding: 15px; margin-bottom: 15px; background-color: #f9f9f9; border-radius: 10px;">
                    <div class="message" style="margin-bottom: 10px; padding: 10px; background-color: white; border-radius: 8px;">
                        <strong>Admin:</strong> Ch√†o m·ª´ng c√°c b·∫°n ƒë·∫øn v·ªõi nh√≥m chat l·ªõp 7A7! üéâ
                    </div>
                </div>
                <div class="chat-input" style="display: flex; gap: 10px;">
                    <input type="text" id="chatInput" placeholder="Nh·∫≠p tin nh·∫Øn..." style="flex: 1; padding: 12px; border: 2px solid #498e4c; border-radius: 10px; font-size: 16px;">
                    <button onclick="sendChatMessage()" style="padding: 12px 24px; background-color: #498e4c; color: white; border: none; border-radius: 10px; cursor: pointer; font-weight: bold;">G·ª≠i</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Tin t·ª©c Modal -->
    <div id="modal-tin-tuc" class="modal" onclick="closeModal(event, 'tin-tuc')">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h2>üìù Tin t·ª©c l·ªõp h·ªçc</h2>
                <button class="close-btn" onclick="closeModal(event, 'tin-tuc')">√ó</button>
            </div>
            <div class="modal-body">
                <h3>Th√¥ng b√°o m·ªõi nh·∫•t</h3>
                <div class="announcement">
                    <h4>üìÖ Th√¥ng b√°o l·ªãch thi</h4>
                    <p>K·ª≥ thi gi·ªØa h·ªçc k√¨ 2 s·∫Ω di·ªÖn ra v√†o tu·∫ßn sau. H√£y √¥n t·∫≠p k·ªπ!</p>
                    <small>ƒêƒÉng ng√†y: 30/01/2026</small>
                </div>
                <div class="announcement">
                    <h4>üèÜ Cu·ªôc thi to√°n h·ªçc</h4>
                    <p>L·ªõp 7A7 s·∫Ω tham gia cu·ªôc thi to√°n h·ªçc c·∫•p tr∆∞·ªùng. Ai mu·ªën tham gia ƒëƒÉng k√Ω nh√©!</p>
                    <small>ƒêƒÉng ng√†y: 25/01/2026</small>
                </div>
            </div>
        </div>
    </div>

    <!-- H·ªèi B√†i Modal -->
    <div id="modal-hoi-bai" class="modal" onclick="closeModal(event, 'hoi-bai')">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h2>‚ùì H·ªèi B√†i</h2>
                <button class="close-btn" onclick="closeModal(event, 'hoi-bai')">√ó</button>
            </div>
            <div class="modal-body">
                <h3>ƒê·∫∑t c√¢u h·ªèi v·ªÅ b√†i h·ªçc</h3>
                <p>N·∫øu c√≥ b√†i n√†o kh√¥ng hi·ªÉu, h√£y h·ªèi ·ªü ƒë√¢y nh√©! üìö</p>
                <div class="homework-questions" style="max-height: 350px; overflow-y: auto; margin-bottom: 20px;">
                    <div class="question" style="background-color: #f9f9f9; padding: 15px; margin-bottom: 10px; border-radius: 8px; border-left: 4px solid #498e4c;">
                        <strong>Minh:</strong> Ai c√≥ b√†i gi·∫£i b√†i t·∫≠p To√°n trang 45 kh√¥ng?
                    </div>
                    <div class="question" style="background-color: #f9f9f9; padding: 15px; margin-bottom: 10px; border-radius: 8px; border-left: 4px solid #498e4c;">
                        <strong>Lan:</strong> Th·∫ßy c√¥ giao b√†i t·∫≠p g√¨ h√¥m nay v·∫≠y c√°c b·∫°n?
                    </div>
                </div>
                <div class="ask-question" style="display: flex; gap: 10px;">
                    <input type="text" id="questionInput" placeholder="H·ªèi c√¢u g√¨ ƒë√≥..." style="flex: 1; padding: 12px; border: 2px solid #498e4c; border-radius: 10px; font-size: 16px;">
                    <button onclick="askQuestion()" style="padding: 12px 24px; background-color: #498e4c; color: white; border: none; border-radius: 10px; cursor: pointer; font-weight: bold;">H·ªèi</button>
                </div>
            </div>
        </div>
    </div>

    <!-- H·ªçc T·∫≠p Modal -->
    <div id="modal-hoc-tap" class="modal" onclick="closeModal(event, 'hoc-tap')">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h2>üìö H·ªçc T·∫≠p</h2>
                <button class="close-btn" onclick="closeModal(event, 'hoc-tap')">√ó</button>
            </div>
            <div class="modal-body">
                <h3>T√†i li·ªáu h·ªçc t·∫≠p</h3>
                <ul>
                    <li>üìñ S√°ch gi√°o khoa To√°n 7</li>
                    <li>üìñ S√°ch gi√°o khoa Ng·ªØ vƒÉn 7</li>
                    <li>üìñ S√°ch gi√°o khoa Khoa h·ªçc 7</li>
                    <li>üìñ S√°ch gi√°o khoa L·ªãch s·ª≠ 7</li>
                    <li>üìñ S√°ch gi√°o khoa ƒê·ªãa l√Ω 7</li>
                </ul>
                <h3>Video b√†i gi·∫£ng</h3>
                <ul>
                    <li>üé• To√°n 7 - Ch∆∞∆°ng 1</li>
                    <li>üé• Ng·ªØ vƒÉn 7 - VƒÉn h·ªçc Vi·ªát Nam</li>
                    <li>üé• Khoa h·ªçc 7 - V·∫≠t l√Ω c∆° b·∫£n</li>
                </ul>
                <h3>ƒê·ªÅ thi v√† b√†i t·∫≠p</h3>
                <ul>
                    <li>üìù ƒê·ªÅ thi gi·ªØa k·ª≥ c√°c m√¥n</li>
                    <li>üìù B√†i t·∫≠p √¥n t·∫≠p</li>
                    <li>üìù ƒê·ªÅ thi h·ªçc k·ª≥ nƒÉm tr∆∞·ªõc</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- L·ªãch h·ªçc Modal -->
    <div id="modal-lich-hoc" class="modal" onclick="closeModal(event, 'lich-hoc')">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h2>üìÖ L·ªãch l·ªõp h·ªçc</h2>
                <button class="close-btn" onclick="closeModal(event, 'lich-hoc')">√ó</button>
            </div>
            <div class="modal-body" id="full-schedule-body">
                <!-- Generated by JavaScript -->
            </div>
        </div>
    </div>

    <!-- Pomodoro Modal -->
    <div id="modal-pomodoro" class="modal" onclick="closeModal(event, 'pomodoro')">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h2>‚è±Ô∏è Pomodoro Timer</h2>
                <button class="close-btn" onclick="closeModal(event, 'pomodoro')">√ó</button>
            </div>
            <div class="modal-body" style="text-align: center;">
                <h3>K·ªπ thu·∫≠t Pomodoro</h3>
                <p>H·ªçc 25 ph√∫t, ngh·ªâ 5 ph√∫t! üçÖ</p>
                <div id="timer-display" style="font-size: 72px; font-weight: 800; color: #FF6B6B; margin: 30px 0;">25:00</div>
                <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
                    <button onclick="startPomodoro()" style="padding: 15px 30px; background-color: #498e4c; color: white; border: none; border-radius: 10px; cursor: pointer; font-size: 18px; font-weight: bold;">‚ñ∂ B·∫Øt ƒë·∫ßu</button>
                    <button onclick="pausePomodoro()" style="padding: 15px 30px; background-color: #FF9800; color: white; border: none; border-radius: 10px; cursor: pointer; font-size: 18px; font-weight: bold;">‚è∏ T·∫°m d·ª´ng</button>
                    <button onclick="resetPomodoro()" style="padding: 15px 30px; background-color: #FF6B6B; color: white; border: none; border-radius: 10px; cursor: pointer; font-size: 18px; font-weight: bold;">‚Ü∫ ƒê·∫∑t l·∫°i</button>
                </div>
                <div id="pomodoro-status" style="margin-top: 20px; font-size: 18px; color: #666;">S·∫µn s√†ng b·∫Øt ƒë·∫ßu!</div>
                <div style="margin-top: 30px; text-align: left; background: #f9f9f9; padding: 20px; border-radius: 10px;">
                    <h4 style="color: #498e4c; margin-top: 0;">C√°ch s·ª≠ d·ª•ng:</h4>
                    <ol style="line-height: 1.8;">
                        <li>Ch·ªçn m·ªôt nhi·ªám v·ª• h·ªçc t·∫≠p</li>
                        <li>B·∫•m "B·∫Øt ƒë·∫ßu" v√† t·∫≠p trung h·ªçc 25 ph√∫t</li>
                        <li>Khi h·∫øt gi·ªù, ngh·ªâ ng∆°i 5 ph√∫t</li>
                        <li>Sau 4 chu k·ª≥, ngh·ªâ d√†i 15-30 ph√∫t</li>
                    </ol>
                </div>
            </div>
        </div>
    </div>

    <script>
      // Schedule data based on the timetable
      const scheduleData = {
        2: { // Th·ª© 2 (Monday)
          day: 'Th·ª© 2',
          morning: [
            { time: 'Ti·∫øt 1', subject: 'NT (Nh·∫°c)' },
            { time: 'Ti·∫øt 2', subject: 'KHTN(Sinh)' },
            { time: 'Ti·∫øt 3', subject: 'VƒÉn' },
            { time: 'Ti·∫øt 4', subject: 'Ngo·∫°i Ng·ªØ' }
          ],
          afternoon: [
            { time: 'Ti·∫øt 1', subject: 'C√¥ng ngh·ªá' },
            { time: 'Ti·∫øt 2', subject: 'KHTN (L√≠)' },
            { time: 'Ti·∫øt 3', subject: 'To√°n' }
          ]
        },
        3: { // Th·ª© 3 (Tuesday)
          day: 'Th·ª© 3',
          morning: [
            { time: 'Ti·∫øt 1', subject: 'GDTC' },
            { time: 'Ti·∫øt 2', subject: 'Ng·ªØ vƒÉn' },
            { time: 'Ti·∫øt 3', subject: 'GDDP' },
            { time: 'Ti·∫øt 4', subject: 'To√°n' }
          ],
          afternoon: []
        },
        4: { // Th·ª© 4 (Wednesday)
          day: 'Th·ª© 4',
          morning: [
            { time: 'Ti·∫øt 1', subject: 'Ng·ªØ vƒÉn' },
            { time: 'Ti·∫øt 2', subject: 'To√°n' },
            { time: 'Ti·∫øt 3', subject: 'KHTN(Sinh)' },
            { time: 'Ti·∫øt 4', subject: 'GDCD' }
          ],
          afternoon: [
            { time: 'Ti·∫øt 1', subject: 'HƒêTN' },
            { time: 'Ti·∫øt 2', subject: 'Ngo·∫°i Ng·ªØ' },
            { time: 'Ti·∫øt 3', subject: 'LS ƒêL (S·ª≠)' }
          ]
        },
        5: { // Th·ª© 5 (Thursday)
          day: 'Th·ª© 5',
          morning: [
            { time: 'Ti·∫øt 1', subject: 'Ngo·∫°i Ng·ªØ' },
            { time: 'Ti·∫øt 2', subject: 'LS ƒêL (ƒê·ªãa)' },
            { time: 'Ti·∫øt 3', subject: 'GDTC' },
            { time: 'Ti·∫øt 4', subject: 'NT (MT)' }
          ],
          afternoon: [
            { time: 'Ti·∫øt 1', subject: 'KHTN(Sinh)' },
            { time: 'Ti·∫øt 2', subject: 'LS ƒêL (t√πy)' },
            { time: 'Ti·∫øt 3', subject: 'HƒêTN' }
          ]
        },
        6: { // Th·ª© 6 (Friday)
          day: 'Th·ª© 6',
          morning: [
            { time: 'Ti·∫øt 1', subject: 'Tin h·ªçc' },
            { time: 'Ti·∫øt 2', subject: 'To√°n' },
            { time: 'Ti·∫øt 3', subject: 'Ng·ªØ vƒÉn' },
            { time: 'Ti·∫øt 4', subject: 'HƒêTN' }
          ],
          afternoon: []
        }
      };

      // Modal Functions
      function openModal(modalId) {
        if (modalId === 'lich-hoc') {
          generateFullSchedule();
        }
        const modal = document.getElementById('modal-' + modalId);
        modal.classList.add('active');
        document.body.style.overflow = 'hidden';
      }

      function closeModal(event, modalId) {
        const modal = document.getElementById('modal-' + modalId);
        modal.classList.remove('active');
        document.body.style.overflow = 'auto';
      }

      // Chat functions
      function sendChatMessage() {
        const input = document.getElementById('chatInput');
        const message = input.value.trim();
        if (message) {
          const messagesDiv = document.getElementById('chatMessages');
          const newMessage = document.createElement('div');
          newMessage.className = 'message';
          newMessage.style.marginBottom = '10px';
          newMessage.style.padding = '10px';
          newMessage.style.backgroundColor = 'white';
          newMessage.style.borderRadius = '8px';
          newMessage.innerHTML = `<strong>B·∫°n:</strong> ${message}`;
          messagesDiv.appendChild(newMessage);
          input.value = '';
          messagesDiv.scrollTop = messagesDiv.scrollHeight;
        }
      }

      // Question functions
      function askQuestion() {
        const input = document.getElementById('questionInput');
        const question = input.value.trim();
        if (question) {
          const questionsDiv = document.querySelector('.homework-questions');
          const newQuestion = document.createElement('div');
          newQuestion.className = 'question';
          newQuestion.style.backgroundColor = '#f9f9f9';
          newQuestion.style.padding = '15px';
          newQuestion.style.marginBottom = '10px';
          newQuestion.style.borderRadius = '8px';
          newQuestion.style.borderLeft = '4px solid #498e4c';
          newQuestion.innerHTML = `<strong>B·∫°n:</strong> ${question}`;
          questionsDiv.appendChild(newQuestion);
          input.value = '';
          questionsDiv.scrollTop = questionsDiv.scrollHeight;
        }
      }

      // Enter key support for chat and questions
      document.addEventListener('DOMContentLoaded', function() {
        const chatInput = document.getElementById('chatInput');
        if (chatInput) {
          chatInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') sendChatMessage();
          });
        }
        
        const questionInput = document.getElementById('questionInput');
        if (questionInput) {
          questionInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') askQuestion();
          });
        }
      });

      // Pomodoro Timer
      let pomodoroInterval = null;
      let pomodoroSeconds = 25 * 60; // 25 minutes
      let isWorkSession = true;

      function updatePomodoroDisplay() {
        const minutes = Math.floor(pomodoroSeconds / 60);
        const seconds = pomodoroSeconds % 60;
        document.getElementById('timer-display').textContent = 
          `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
      }

      function startPomodoro() {
        if (pomodoroInterval) return; // Already running
        
        document.getElementById('pomodoro-status').textContent = isWorkSession ? 
          'üéØ ƒêang h·ªçc t·∫≠p - T·∫≠p trung!' : '‚òï ƒêang ngh·ªâ ng∆°i';
        
        pomodoroInterval = setInterval(() => {
          pomodoroSeconds--;
          updatePomodoroDisplay();
          
          if (pomodoroSeconds <= 0) {
            clearInterval(pomodoroInterval);
            pomodoroInterval = null;
            
            if (isWorkSession) {
              alert('üéâ H·∫øt gi·ªù h·ªçc! Ngh·ªâ ng∆°i 5 ph√∫t nh√©!');
              pomodoroSeconds = 5 * 60;
              isWorkSession = false;
            } else {
              alert('‚è∞ H·∫øt gi·ªù ngh·ªâ! Ti·∫øp t·ª•c h·ªçc th√¥i!');
              pomodoroSeconds = 25 * 60;
              isWorkSession = true;
            }
            updatePomodoroDisplay();
            document.getElementById('pomodoro-status').textContent = 'S·∫µn s√†ng b·∫Øt ƒë·∫ßu!';
          }
        }, 1000);
      }

      function pausePomodoro() {
        if (pomodoroInterval) {
          clearInterval(pomodoroInterval);
          pomodoroInterval = null;
          document.getElementById('pomodoro-status').textContent = '‚è∏ ƒê√£ t·∫°m d·ª´ng';
        }
      }

      function resetPomodoro() {
        if (pomodoroInterval) {
          clearInterval(pomodoroInterval);
          pomodoroInterval = null;
        }
        pomodoroSeconds = 25 * 60;
        isWorkSession = true;
        updatePomodoroDisplay();
        document.getElementById('pomodoro-status').textContent = 'S·∫µn s√†ng b·∫Øt ƒë·∫ßu!';
      }

      // Full schedule display
      function generateFullSchedule() {
        const scheduleBody = document.getElementById('full-schedule-body');
        let html = '<h3>Th·ªùi kh√≥a bi·ªÉu tu·∫ßn</h3>';
        
        const days = {
          2: 'Th·ª© 2',
          3: 'Th·ª© 3',
          4: 'Th·ª© 4',
          5: 'Th·ª© 5',
          6: 'Th·ª© 6'
        };
        
        for (let day in days) {
          const schedule = scheduleData[day];
          html += `<h4>${schedule.day}</h4>`;
          
          if (schedule.morning && schedule.morning.length > 0) {
            html += '<p><strong>S√°ng:</strong> ';
            html += schedule.morning.map(p => p.subject).join(', ');
            html += '</p>';
          }
          
          if (schedule.afternoon && schedule.afternoon.length > 0) {
            html += '<p><strong>Chi·ªÅu:</strong> ';
            html += schedule.afternoon.map(p => p.subject).join(', ');
            html += '</p>';
          }
        }
        
        html += '<h3 style="margin-top: 30px;">S·ª± ki·ªán s·∫Øp t·ªõi</h3>';
        html += '<p>üéä <strong>Ng√†y h·ªôi th·ªÉ thao:</strong> 15/02/2026</p>';
        html += '<p>üé® <strong>Tri·ªÉn l√£m m·ªπ thu·∫≠t:</strong> 20/02/2026</p>';
        
        scheduleBody.innerHTML = html;
      }

      // Real online counter using localStorage
      const HEARTBEAT_INTERVAL = 5000; // 5 seconds
      const ONLINE_TIMEOUT = 15000; // 15 seconds - if no heartbeat, consider offline
      const userId = 'user_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);

      function updateHeartbeat() {
        const now = Date.now();
        const onlineUsers = JSON.parse(localStorage.getItem('onlineUsers') || '{}');
        
        // Add or update current user
        onlineUsers[userId] = now;
        
        // Remove users who haven't sent heartbeat in ONLINE_TIMEOUT
        Object.keys(onlineUsers).forEach(id => {
          if (now - onlineUsers[id] > ONLINE_TIMEOUT) {
            delete onlineUsers[id];
          }
        });
        
        localStorage.setItem('onlineUsers', JSON.stringify(onlineUsers));
        updateOnlineDisplay(Object.keys(onlineUsers).length);
      }

      function updateOnlineDisplay(count) {
        document.getElementById('onlineCount').textContent = count;
      }

      // Listen for localStorage changes from other tabs
      window.addEventListener('storage', function(e) {
        if (e.key === 'onlineUsers') {
          const onlineUsers = JSON.parse(e.newValue || '{}');
          const now = Date.now();
          
          // Filter out expired users
          const activeUsers = Object.keys(onlineUsers).filter(id => {
            return now - onlineUsers[id] <= ONLINE_TIMEOUT;
          });
          
          updateOnlineDisplay(activeUsers.length);
        }
      });

      // Send heartbeat regularly
      setInterval(updateHeartbeat, HEARTBEAT_INTERVAL);
      updateHeartbeat(); // Initial call

      // Remove user when leaving
      window.addEventListener('beforeunload', function() {
        const onlineUsers = JSON.parse(localStorage.getItem('onlineUsers') || '{}');
        delete onlineUsers[userId];
        localStorage.setItem('onlineUsers', JSON.stringify(onlineUsers));
      });

      // Close modal with Escape key
      document.addEventListener('keydown', function(event) {
        if (event.key === 'Escape') {
          const activeModal = document.querySelector('.modal.active');
          if (activeModal) {
            activeModal.classList.remove('active');
            document.body.style.overflow = 'auto';
          }
        }
      });
    </script>
</body>
</html>
